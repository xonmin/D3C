# 4.2.7 InnoDB Buffer Pool

- 디스크의 데이터 파일이나 인덱스 정보를 메모리에 캐시해 두는 공간
- write 작업을 batch로 처리하는 버퍼역할도 수행

### 4.2.7.1 버퍼 풀의 크기 설정
MySQL 5.7 버전부터 InnoDB 버퍼 풀의 크기 동적 조절 가능
- 버퍼 풀의 크기는 운영체제와 각 클라이언트 스레드가 사용할 메모리를 고려해서 설정해야 한다. 
  - `innodb_buffer_pool_size` 시스템 변수로 크기를 설정
- 크기를 늘리는건 시스템에 큰 영향을 주지 않지만, 크기를 줄이는 작업은 서비스 영향도가 매우 크기 때문에 주의
- 버퍼 풀 전체를 관리하는 잠금(세마포어)로 인해 내부 잠금 경합이 많았는데 내부 잠금 경합을 줄이기 위해 버퍼 풀을 여러 개로 쪼개어 관리할수 있게 가능.
  - `innodb_buffer_pool_instances` 변수 사용 

### 4.2.7.2 버퍼 풀의 구조
- LRU list, Flush List, Free List 

**LRU 리스트**
![image](https://user-images.githubusercontent.com/27190617/215272527-f97f30f9-c45a-4bfe-a35f-5f4d8ae0c49a.png)
- InnoDB 버퍼풀에 최대한 오래 캐시하여, 디스크 읽기를 최소화 하는 것이 목적
- double linked list 형태 + Map 을 활용하여 읽기, 쓰기의 속도 향상

**Flush List**
- 디스크로 동기화되지 않은 데이터를 가진 데이터 페이지(더티 페이지)의 변경 시점 기준의 페이지 목록

**Free List**
- 버퍼 풀에서 실제 사용자 데이터로 채워지지 않은 비어 있는 페이지들의 목록
- 쿼리가 새롭게 디스크의 데이터 페이지를 읽어와야 하는 경우 사용
### 4.2.7.3 버퍼 풀과 리두 로그
- InnoDB 버퍼 풀은 데이터 베이스 서버의 성능 향상을 위해 데이터 캐시와 쓰기 버퍼링 이라는 두가지 용도 존재
  - 버퍼 풀의 메모리 공간만 늘리는것은 데이터 캐시기능만 향상
>  쓰기 버퍼링 기능 향상을 위해서는 InnoDB 버퍼 풀과 리두 로그와의 관계를 이해아혀야함.
